<!DOCTYPE html>
<html lang="vi" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.128.2">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="//localhost:1313/images/favicon.png" type="image/png">

    <title>Làm giàu kết quả bảo mật với dữ liệu điều tra :: AWS System Manager</title>

    
    <link href="//localhost:1313/css/nucleus.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/fontawesome-all.min.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/hybrid.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/featherlight.min.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/perfect-scrollbar.min.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/auto-complete.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/atom-one-dark-reasonable.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/theme.css?1724174125" rel="stylesheet">
    <link href="//localhost:1313/css/hugo-theme.css?1724174125" rel="stylesheet">
    
    <link href="//localhost:1313/css/theme-workshop.css?1724174125" rel="stylesheet">
    
    

    <script src="//localhost:1313/js/jquery-3.3.1.min.js?1724174125"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="//localhost:1313/vi/5/5.5/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="//localhost:1313/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="//localhost:1313/js/lunr.min.js?1724174125"></script>
<script type="text/javascript" src="//localhost:1313/js/auto-complete.js?1724174125"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/localhost:1313\/\/vi";
    
</script>
<script type="text/javascript" src="//localhost:1313/js/search.js?1724174125"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/vi/1-workshop-instructions/" title="Giới thiệu workshop" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/1-workshop-instructions/">
           <b> 1. </b> Giới thiệu workshop
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/" title="Giới thiệu về các dịch vụ phát hiện và ứng phó mối đe dọa" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/">
           <b> 2. </b> Giới thiệu về các dịch vụ phát hiện và ứng phó mối đe dọa
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/" title="AWS Security Hub" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/">
           <b> 2.1 </b> AWS Security Hub
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.1-security-hub-overview/" title="Security Hub - Tổng quan" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.1-security-hub-overview/">
           <b> 2.1.1 </b> Security Hub - Tổng quan
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.2-security-hub-dashboard/" title="Security Hub - Bảng điều khiển" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.2-security-hub-dashboard/">
           <b> 2.1.2 </b> Security Hub - Bảng điều khiển
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.3-security-hub-findings/" title="Security Hub - Phát hiện sai phạm" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.3-security-hub-findings/">
           <b> 2.1.3 </b> Security Hub - Phát hiện sai phạm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.4-security-hub-pricing/" title="Security Hub - Chi phí" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.4-security-hub-pricing/">
           <b> 2.1.4 </b> Security Hub - Chi phí
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.5-security-hub-notifications/" title="Security Hub - Thông báo" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.5-security-hub-notifications/">
           <b> 2.1.5 </b> Security Hub - Thông báo
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/" title="Amazon GuardDuty" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/">
           <b> 2.2 </b> Amazon GuardDuty
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.1-guardduty-overview/" title="GuardDuty - Tổng quan" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.1-guardduty-overview/">
           <b> 2.2.1 </b> GuardDuty - Tổng quan
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.2-guardduty-findings/" title="GuardDuty - Phát hiện sai phạm" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.2-guardduty-findings/">
           <b> 2.2.2 </b> GuardDuty - Phát hiện sai phạm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.3-guardduty-protection-plans/" title="GuardDuty - Kế hoạch bảo vệ" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.3-guardduty-protection-plans/">
           <b> 2.2.3 </b> GuardDuty - Kế hoạch bảo vệ
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.4-guardduty-building-your-own-threat-list/" title="GuardDuty - Xây dựng danh sách mối đe dọa của riêng bạn" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.4-guardduty-building-your-own-threat-list/">
           <b> 2.2.4 </b> GuardDuty - Xây dựng danh sách mối đe dọa của riêng bạn
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.5-guardduty-suppressing-findings/" title="GuardDuty - Ẩn phát hiện" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.5-guardduty-suppressing-findings/">
           <b> 2.2.5 </b> GuardDuty - Ẩn phát hiện
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.6-guradduty-pricing/" title="GuradDuty - Chi phí" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.6-guradduty-pricing/">
           <b> 2.2.6 </b> GuradDuty - Chi phí
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.7-guardduty-notifications/" title="GuardDuty - Thông báo" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.7-guardduty-notifications/">
           <b> 2.2.7 </b> GuardDuty - Thông báo
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.8-guardduty-retaining-findings/" title="GuardDuty - Giữ lại các phát hiện" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.8-guardduty-retaining-findings/">
           <b> 2.2.8 </b> GuardDuty - Giữ lại các phát hiện
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/" title="Amazon Inspector" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/">
           <b> 2.3 </b> Amazon Inspector
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.1-inspector-overview/" title="Inspector - Tổng quan" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.1-inspector-overview/">
           <b> 2.3.1 </b> Inspector - Tổng quan
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.2-inspector-dashboard/" title="Inspector - Bảng điều khiển" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.2-inspector-dashboard/">
           <b> 2.3.2 </b> Inspector - Bảng điều khiển
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.3-inspector-findings/" title="Inspector  - Phát hiện sai phạm" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.3-inspector-findings/">
           <b> 2.3.3 </b> Inspector  - Phát hiện sai phạm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.4-inspector-vulnerability-database-search/" title="Inspector - Tìm kiếm trong cơ sở dữ liệu về lỗ hổng" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.4-inspector-vulnerability-database-search/">
           <b> 2.3.4 </b> Inspector - Tìm kiếm trong cơ sở dữ liệu về lỗ hổng
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.5-inspector-suppressing-findings/" title="Inspector - Ẩn phát hiện" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.5-inspector-suppressing-findings/">
           <b> 2.3.5 </b> Inspector - Ẩn phát hiện
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.6-inspector-pricing/" title="Inspector - Chi phí" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.6-inspector-pricing/">
           <b> 2.3.6 </b> Inspector - Chi phí
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/" title="Amazon Detective" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/">
           <b> 2.4 </b> Amazon Detective
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.1-detective-overview/" title="Detective - Tổng quan" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.1-detective-overview/">
           <b> 2.4.1 </b> Detective - Tổng quan
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.2-detective-summary/" title="Detective - Tóm tắt" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.2-detective-summary/">
           <b> 2.4.2 </b> Detective - Tóm tắt
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.3-detective-search/" title="Detective - Tìm kiếm" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.3-detective-search/">
           <b> 2.4.3 </b> Detective - Tìm kiếm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.4-detective-investigations/" title="Detective - Điều tra" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.4-detective-investigations/">
           <b> 2.4.4 </b> Detective - Điều tra
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.5-detective-finding-groups/" title="Detective - Nhóm phát Hiện" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.5-detective-finding-groups/">
           <b> 2.4.5 </b> Detective - Nhóm phát Hiện
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.6-detective-pricing/" title="Detective - Chi phí" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.6-detective-pricing/">
           <b> 2.4.6 </b> Detective - Chi phí
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.7-detective-eks-audit-logs/" title="Detective - EKS Audit Logs" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.7-detective-eks-audit-logs/">
           <b> 2.4.7 </b> Detective - EKS Audit Logs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/3/" title="Tích hợp Dịch vụ AWS và Giải pháp Đối tác" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/3/">
           <b> 3. </b> Tích hợp Dịch vụ AWS và Giải pháp Đối tác
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/3/3.1/" title="Tập trung các phát hiện từ các dịch vụ bảo mật AWS" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/3/3.1/">
           <b> 3.1. </b> Tập trung các phát hiện từ các dịch vụ bảo mật AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3/3.2/" title="Tổng hợp phát hiện từ nhiều tài khoản AWS" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/3/3.2/">
           <b> 3.2. </b> Tổng hợp phát hiện từ nhiều tài khoản AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3/3.3/" title="Tập hợp các phát hiện từ các giải pháp của đối tác AWS" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/3/3.3/">
           <b> 3.3. </b> Tập hợp các phát hiện từ các giải pháp của đối tác AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3/3.4/" title="Tổng hợp tìm kiếm qua các Region" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/3/3.4/">
           <b> 3.4. </b> Tổng hợp tìm kiếm qua các Region
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3/3.5/" title="Xây dựng tích hợp Security Hub của riêng bạn" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/3/3.5/">
           <b> 3.5. </b> Xây dựng tích hợp Security Hub của riêng bạn
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/4/" title="Quản lý và Ưu tiên các phát hiện bảo mật" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/4/">
           <b> 4. </b> Quản lý và Ưu tiên các phát hiện bảo mật
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/4/4.1/" title="Tự động hóa uu tiên các phát hiện quy mô lớn bằng " class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/4/4.1/">
           <b> 4.1 </b> Tự động hóa uu tiên các phát hiện quy mô lớn bằng 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/4/4.2/" title="Ẩn các phát hiện quy mô lớn bằng tự động hóa" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/4/4.2/">
           <b> 4.2 </b> Ẩn các phát hiện quy mô lớn bằng tự động hóa
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/4/4.3/" title="Sử dụng insights để ưu tiên và đo lường" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/4/4.3/">
           <b> 4.3 </b> Sử dụng insights để ưu tiên và đo lường
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/5/" title="Tự động hóa thông báo và ứng phó" class="dd-item 
        parent
        
        
        ">
      <a href="//localhost:1313/vi/5/">
           <b> 5. </b> Tự động hóa thông báo và ứng phó
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/5/5.1/" title="Thiết lập thông báo" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/5/5.1/">
           <b> 5.1 </b> Thiết lập thông báo
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/5/5.2/" title="Thiết lập email tổng kết lỗ hổng hàng tuần" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/5/5.2/">
           <b> 5.2 </b> Thiết lập email tổng kết lỗ hổng hàng tuần
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/5/5.3/" title="Tự động ứng phó bảo mật trên AWS" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/5/5.3/">
           <b> 5.3 </b> Tự động ứng phó bảo mật trên AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/5/5.4/" title="Building your own automated response" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/5/5.4/">
           <b> 5.4 </b> Building your own automated response
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/5/5.5/" title="Làm giàu kết quả bảo mật với dữ liệu điều tra" class="dd-item 
        
        active
        
        ">
      <a href="//localhost:1313/vi/5/5.5/">
           <b> 5.5 </b> Làm giàu kết quả bảo mật với dữ liệu điều tra
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/6/" title="Mô phỏng và kịch bản bảo mật" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/6/">
           <b> 6. </b> Mô phỏng và kịch bản bảo mật
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/6/6.1/" title="Ứng phó đối với việc rò rỉ thông tin xác thực IAM Role" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/6/6.1/">
           <b> 6.1 </b> Ứng phó đối với việc rò rỉ thông tin xác thực IAM Role
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/6/6.2/" title="Ứng phó với S3 Bucket bị xâm phạm" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/6/6.2/">
           <b> 6.2 </b> Ứng phó với S3 Bucket bị xâm phạm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/6/6.3/" title="Ứng phó khi thông tin xác thực IAM bị xâm phạm" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/6/6.3/">
           <b> 6.3 </b> Ứng phó khi thông tin xác thực IAM bị xâm phạm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/6/6.4/" title="Ứng phó khi một hàm Lambda gọi đến IP độc hại" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/6/6.4/">
           <b> 6.4 </b> Ứng phó khi một hàm Lambda gọi đến IP độc hại
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/6/6.5/" title="Ứng phó với mã độc trên Amazon Elastic Block Store" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/6/6.5/">
           <b> 6.5 </b> Ứng phó với mã độc trên Amazon Elastic Block Store
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/6/6.6/" title="Ứng phó với mã độc trên Amazon Elastic Block Store" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/6/6.6/">
           <b> 6.5 </b> Ứng phó với mã độc trên Amazon Elastic Block Store
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/7/" title="Quản lý Lỗ hổng Phần mềm" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/7/">
           <b> 7. </b> Quản lý Lỗ hổng Phần mềm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/7/7.1/" title="Cập nhật bản vá cho EC2 với Patch Manager" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/7/7.1/">
           <b> 7.1 </b> Cập nhật bản vá cho EC2 với Patch Manager
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/7/7.2/" title="Quản lý lỗ hổng bảo mật cho các ứng dụng serverless" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/7/7.2/">
           <b> 7.2 </b> Quản lý lỗ hổng bảo mật cho các ứng dụng serverless
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/7/7.3/" title="Tích hợp Amazon Inspector vào quy trình CI/CD" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/7/7.3/">
           <b> 7.3 </b> Tích hợp Amazon Inspector vào quy trình CI/CD
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/8/" title="Dọn dẹp tài nguyên" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/vi/8/">
          <b>8. </b>Dọn dẹp tài nguyên
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="//localhost:1313/5/5.5/">English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="//localhost:1313/vi/5/5.5/" selected>Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>19-08-2024</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Author </b> <br>
           
            <i><a href="https://www.linkedin.com/in/anhpnh"  style="color:orange">Hải Anh </a> <br>
                
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='//localhost:1313/vi/'>Threat Detection & Response Workshop</a> > <a href='//localhost:1313/vi/5/'>Tự động hóa thông báo và ứng phó</a> > Làm giàu kết quả bảo mật với dữ liệu điều tra
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Làm giàu kết quả bảo mật với dữ liệu điều tra
            </h1>
          

        



	<p>Trong bối cảnh mối đe dọa đang thay đổi nhanh chóng ngày nay, việc hiểu rõ rủi ro và tìm ra nguyên nhân gốc rễ của một vấn đề một cách kịp thời là điều quan trọng đối với các doanh nghiệp. <strong>Amazon Detective</strong> giúp dễ dàng phân tích, điều tra và nhanh chóng xác định nguyên nhân gốc rễ của các vấn đề bảo mật tiềm ẩn hoặc hoạt động đáng ngờ. <strong>Amazon Detective</strong> hỗ trợ khả năng tự động điều tra các thực thể <strong>AWS Identity and Access Management (IAM)</strong> để tìm các chỉ báo về việc bị xâm phạm (<strong>IoC</strong>). Khả năng này giúp các nhà phân tích bảo mật xác định xem các thực thể <strong>IAM</strong> có thể đã bị xâm phạm hoặc tham gia vào bất kỳ chiến thuật, kỹ thuật và quy trình (<strong>TTP</strong>) nào được biết đến từ <strong>MITRE ATT&amp;CK framework</strong>. Bạn có thể sử dụng <strong>Detective Investigation API</strong> một cách lập trình để giúp điều tra các vấn đề bảo mật tiềm ẩn.</p>
<p><strong>Security Hub</strong> là một công cụ quản lý tư thế bảo mật trên đám mây tự động phát hiện khi các tài khoản và tài nguyên <strong>AWS</strong> của bạn không tuân theo các phương pháp bảo mật tốt nhất, tổng hợp các cảnh báo bảo mật vào một nơi và định dạng duy nhất, và hiểu rõ tư thế bảo mật tổng thể của bạn trên tất cả các tài khoản <strong>AWS</strong> của bạn. <strong>Security Hub</strong> cung cấp cho bạn tùy chọn gửi <strong>findings</strong> đến một giải pháp bảo mật khác, chẳng hạn như <strong>AWS Security Lake</strong> hoặc một giải pháp của <strong>AWS Partner Network (APN)</strong>. Nhiều khách hàng sử dụng <strong>AWS Security Hub</strong> để phát hiện các cấu hình bảo mật sai và xem xét, ưu tiên các <strong>findings</strong> bảo mật. Họ thích cái nhìn đơn giản, tập trung vào <strong>findings</strong> trong <strong>Security Hub</strong> hơn là việc xem xét và ưu tiên các <strong>findings</strong> trong từng dịch vụ và vùng mà chúng xuất phát.</p>
<p><strong>Amazon GuardDuty</strong> là một dịch vụ phát hiện mối đe dọa thông minh liên tục theo dõi các tài khoản <strong>AWS</strong>, khối lượng công việc, hoạt động runtime và dữ liệu của bạn để tìm hoạt động độc hại. Nếu phát hiện hoạt động độc hại tiềm ẩn, chẳng hạn như hành vi bất thường hoặc rò rỉ thông tin xác thực, <strong>GuardDuty</strong> tạo ra các <strong>findings</strong> bảo mật chi tiết. Khi bạn kích hoạt <strong>GuardDuty</strong> và <strong>Security Hub</strong> trong cùng một tài khoản và cùng một vùng <strong>AWS</strong>, <strong>GuardDuty</strong> sẽ bắt đầu gửi tất cả các <strong>findings</strong> được tạo ra đến <strong>Security Hub</strong>.</p>
<p>Trong module này, bạn sẽ xây dựng một giải pháp tích hợp <strong>Detective</strong> với <strong>Security Hub</strong> giúp bạn có cái nhìn tốt hơn về các chỉ báo mối đe dọa và dữ liệu điều tra trực tiếp từ <strong>Security Hub</strong>. Điều này cho phép bạn thực hiện các cuộc điều tra kịp thời hơn về các <strong>findings</strong> của <strong>GuardDuty</strong> từ một cái nhìn tập trung. Giải pháp sẽ tự động thực hiện làm giàu dữ liệu cho các <strong>findings</strong> có mức độ nghiêm trọng cao và trung bình và cung cấp cho bạn sự linh hoạt để khởi tạo các cuộc điều tra và làm giàu dữ liệu bổ sung theo yêu cầu. Bằng cách làm giàu các <strong>findings</strong> trong <strong>Security Hub</strong>, bạn có tùy chọn xem xét những <strong>findings</strong> đã được làm giàu trực tiếp trong <strong>Security Hub console</strong>, hoặc bạn có thể kích hoạt tích hợp để xem xét các <strong>findings</strong> đã được làm giàu trong giải pháp mà bạn chọn.</p>
<h4 id="the-solution-architecture">The solution architecture</h4>
<p><strong>Security Hub</strong> tự động gửi tất cả các <strong>findings</strong> mới và tất cả các bản cập nhật cho các <strong>findings</strong> hiện có đến <strong>EventBridge</strong> dưới dạng các sự kiện <strong>Security Hub Findings - Imported</strong>. Mỗi sự kiện <strong>Security Hub Findings - Imported</strong> chứa một <strong>finding</strong> duy nhất. <strong>Security Hub</strong> cũng gửi các <strong>findings</strong> liên quan đến các <strong>custom actions</strong> đến <strong>EventBridge</strong> dưới dạng các sự kiện <strong>Security Hub Findings - Custom Action</strong>. Như được hiển thị trong sơ đồ kiến trúc dưới đây, bạn sẽ sử dụng <strong>EventBridge Rules</strong> để gọi một <strong>Lambda function</strong> cho mỗi <strong>finding</strong> mà bạn làm giàu. Bạn sẽ sử dụng một <strong>EventBridge Rule</strong> cho các sự kiện <strong>Imported</strong> để tự động khởi tạo <strong>Lambda function</strong> cho các <strong>findings</strong> có mức độ nghiêm trọng cao (và trung bình) được <strong>Security Hub</strong> tổng hợp từ <strong>GuardDuty</strong>. Bạn sẽ sử dụng một <strong>EventBridge Rule</strong> thứ hai cho các sự kiện <strong>Custom Action</strong> để khởi tạo các cuộc điều tra và làm giàu dữ liệu bổ sung theo yêu cầu. Cả hai <strong>EventBridge Rules</strong> sẽ hướng tới cùng một <strong>Lambda function</strong>. <strong>Lambda function</strong> sẽ gọi <strong>Detective Investigation API</strong>, đợi kết quả, sau đó gọi <strong>Security Hub API</strong> để cập nhật <strong>finding</strong>.</p>
<p><img alt="S3" src="//localhost:1313/images/5/5.5/arch-integration.png"></p>

<div class="notices info" ><p><strong>Scenario / Problem Statement</strong>: Kể từ khi nhóm của bạn bật các dịch vụ bảo mật khác nhau của <strong>AWS</strong> và tổng hợp tất cả mọi thứ trong <strong>Security Hub</strong>, ban lãnh đạo của bạn đang yêu cầu các thông tin chi tiết từ tất cả dữ liệu đó. Cụ thể, bạn đã được yêu cầu rút ra các thông tin chi tiết về tuân thủ, cảnh báo có mức độ ưu tiên cao nhất, và các tài nguyên tạo ra số lượng cảnh báo bảo mật nhiều nhất.</p>
</div>

<h4 id="retrieve-investigative-data-from-detective-using-lambda">Retrieve investigative data from Detective using Lambda</h4>
<p>Bạn có thể bắt đầu các cuộc điều tra trong <strong>Detective</strong> và truy xuất kết quả thông qua <strong>API</strong>. Để làm điều này, bạn sẽ sử dụng một <strong>Lambda function</strong> được viết bằng <strong>JavaScript</strong> (<strong>Node.js 20.x</strong>). <strong>AWS Lambda</strong> hỗ trợ nhiều ngôn ngữ lập trình, nhưng bạn sẽ sử dụng <strong>JavaScript</strong> trong ví dụ này.</p>
<p>Để bắt đầu một cuộc điều tra, bạn phải cung cấp cho <strong>API</strong> một <strong>Amazon Resource Name (ARN)</strong> của một <strong>IAM role</strong> hoặc <strong>user</strong>, thời gian bắt đầu, thời gian kết thúc, và <strong>ARN</strong> của <strong>Detective behavior graph</strong>. <strong>Detective API</strong> sẽ truy xuất kết quả của cuộc điều tra bao gồm các chỉ số về việc bị xâm phạm (<strong>IoC</strong>), <strong>TTPs</strong> (chiến thuật, kỹ thuật và quy trình), và một điểm số mức độ nghiêm trọng theo danh mục. Điểm số mức độ nghiêm trọng được trả về được tính toán bằng cách sử dụng hai chiều; <strong>confidence</strong> và <strong>impact</strong>; trong đó <strong>confidence</strong> đại diện cho khả năng cao các sự kiện là bất thường và không phải là hành vi bình thường của người dùng. Chiều thứ hai là <strong>impact</strong>; điều này định lượng tác hại có thể xảy ra từ các sự kiện như một thước đo ảnh hưởng của <strong>TTPs</strong>.</p>
<ol>
<li>
<p>Đầu tiên, tạo <strong>Lambda function</strong>. Truy cập <a href="https://console.aws.amazon.com/lambda/home?#/create/function?intent=authorFromScratch">https://console.aws.amazon.com/lambda/home?#/create/function?intent=authorFromScratch</a>.</p>
</li>
<li>
<p>Trên trang <strong>Create function</strong>, đặt <strong>Function name</strong> là &ldquo;InvestigateWithDetective&rdquo; và chọn <strong>Node.js 20.x</strong> cho <strong>Runtime</strong>.</p>
</li>
<li>
<p>Giữ nguyên tất cả các cài đặt khác. Nhấp vào <strong>Create function</strong>.</p>
</li>
<li>
<p>Sao chép và dán đoạn mã sau vào trình soạn thảo được gắn nhãn <strong>Code source</strong>. Đây sẽ là mục tiêu của <strong>EventBridge rule</strong> trong kiến trúc. <strong>Function</strong> này lấy <strong>ARN</strong> từ một phát hiện bảo mật của <strong>GuardDuty</strong> được <strong>Security Hub</strong> tổng hợp và gọi <strong>Investigation API</strong>. Khi kết quả được trả về, <strong>function</strong> định dạng dữ liệu thành <strong>AWS Security Finding Format (ASFF)</strong> được sử dụng bởi <strong>Security Hub</strong>, và gọi <strong>BatchUpdateFindings API</strong> để gửi <strong>finding</strong> đã được làm giàu và cập nhật trở lại <strong>Security Hub</strong>.</p>
</li>
</ol>
<pre tabindex="0"><code>&#34;use strict&#34;;
import {
  DetectiveClient,
  GetInvestigationCommand,
  ListGraphsCommand,
  StartInvestigationCommand,
} from &#34;@aws-sdk/client-detective&#34;;
import { BatchUpdateFindingsCommand, SecurityHubClient } from &#34;@aws-sdk/client-securityhub&#34;;

const SHClient = new SecurityHubClient();
const detectiveClient = new DetectiveClient();

export const handler = async (event) =&gt; {
  try {
    // Handle only one (the first) finding per function call
    const finding = event.detail.findings[0];

    if (finding.ProductName != &#34;GuardDuty&#34;) {
      // Handle only GuardDuty findings
      throw new Error(&#34;This is not a GuardDuty finding!&#34;);
    }

    const listgraphs = new ListGraphsCommand({});
    const graphs = await detectiveClient.send(listgraphs);
    const graphArn = graphs.GraphList[0].Arn;

    const IAMResourceARNs = finding.Resources.filter((resource) =&gt; {
      return (
        resource.Type == &#34;AwsIamRole&#34; ||
        resource.Type == &#34;AwsIamUser&#34; ||
        (resource.Type == &#34;AwsIamAccessKey&#34; &amp;&amp; resource.Details.AwsIamAccessKey.PrincipalName != &#34;aws:ec2-instance&#34;)
      );
    }).map((resource) =&gt; {
      if (resource.Type == &#34;AwsIamRole&#34; || resource.Type == &#34;AwsIamUser&#34;) {
        return {
          arn: resource.Id,
          type: resource.Type == &#34;AwsIamRole&#34; ? &#34;role&#34; : &#34;user&#34;,
        };
      } else if (resource.Type == &#34;AwsIamAccessKey&#34;) {
        return {
          arn: `arn:aws:iam::${finding.AwsAccountId}:role/${resource.Details.AwsIamAccessKey.PrincipalName}`,
          type: &#34;role&#34;,
        };
      }
    });

    if (IAMResourceARNs.length == 0) {
      throw new Error(&#34;No IAM resource to investigate!&#34;);
    }

    // Investigate the first IAM role or user identified in the finding
    const investigationTarget = IAMResourceARNs[0].arn;
    const investigationTargetType = IAMResourceARNs[0].type;

    const investigationEndTime = new Date(Date.now());
    investigationEndTime.setMinutes(investigationEndTime.getMinutes() - 5);

    let investigationStartTime;
    if (finding.FirstObservedAt) {
      investigationStartTime = new Date(finding.FirstObservedAt);
    } else if (finding.CreatedAt) {
      investigationStartTime = new Date(finding.CreatedAt);
    } else if (finding.ProcessedAt) {
      investigationStartTime = new Date(finding.ProcessedAt);
    } else {
      throw new Error(&#34;Investigation start time invalid!&#34;);
    }
    investigationStartTime.setHours(investigationStartTime.getHours() - 24);

    const totalInvestigationTime = Math.round(
      (investigationEndTime.getTime() - investigationStartTime.getTime()) / (1000 * 60 * 60),
    ); // Hours

    const startInvestigationRequest = {
      GraphArn: graphArn,
      EntityArn: investigationTarget,
      ScopeStartTime: investigationStartTime,
      ScopeEndTime: investigationEndTime,
    };

    const startinvestigation = new StartInvestigationCommand(startInvestigationRequest);
    const investigation = await detectiveClient.send(startinvestigation);
    const investigationId = investigation.InvestigationId;

    const getInvestigationRequest = {
      GraphArn: graphArn,
      InvestigationId: investigationId,
    };

    let investigationResult = { Status: &#34;RUNNING&#34; };
    while (investigationResult.Status == &#34;RUNNING&#34;) {
      await new Promise((r) =&gt; setTimeout(r, 30000));
      const getinvestigation = new GetInvestigationCommand(getInvestigationRequest);
      investigationResult = await detectiveClient.send(getinvestigation);
      if (investigationResult.Status == &#34;FAILED&#34;) {
        throw new Error(&#34;Detective investigation failed!&#34;);
      }
    }

    let investigationSummary = &#34;&#34;;
    switch (investigationResult.Severity) {
      case &#34;INFORMATIONAL&#34;:
      case &#34;LOW&#34;:
        investigationSummary += `We did not observe uncommon behavior for the associated ${investigationTargetType} during the ${totalInvestigationTime} hour investigation window.`;
        break;
      case &#34;MEDIUM&#34;:
        investigationSummary += `We observed anomalous behavior for the associated ${investigationTargetType} during the ${totalInvestigationTime} hour investigation window which might be indicative of compromise.`;
        break;
      case &#34;HIGH&#34;:
      case &#34;CRITICAL&#34;:
        investigationSummary += `We observed anomalous behavior for the associated ${investigationTargetType} during the ${totalInvestigationTime} hour investigation window indicating potential compromise.`;
        break;
      default:
        throw new Error(&#34;Severity information not found!&#34;);
    }

    investigationSummary += &#34; For more information, visit &#34;;
    investigationSummary += `https://${process.env.AWS_REGION}.console.aws.amazon.com/detective/home?region=${process.env.AWS_REGION}#investigationReport/${investigationResult.InvestigationId}`;

    const findingUpdateInput = {
      FindingIdentifiers: [
        {
          Id: finding.Id,
          ProductArn: finding.ProductArn,
        },
      ],
      Note: {
        Text: investigationSummary.substring(0, 512),
        UpdatedBy: &#34;Detective Investigation Lambda function.&#34;,
      },
      UserDefinedFields: {
        investigate: &#34;complete&#34;,
      },
    };

    const batchUpdateCommand = new BatchUpdateFindingsCommand(findingUpdateInput);
    const updatedFinding = await SHClient.send(batchUpdateCommand);

    return updatedFinding;
  } catch (error) {
    console.error(&#34;Error:&#34;, error);
    throw error;
  }
};
</code></pre><ol start="5">
<li>
<p>Sau đó từ menu <strong>Code source</strong>, nhấp vào <strong>File</strong> rồi <strong>Save</strong>.</p>
</li>
<li>
<p>Sau đó nhấp vào nút <strong>Deploy</strong>.</p>
</li>
<li>
<p>Ngay phía trên phần <strong>Code source</strong> cho <strong>Lambda function</strong> bạn đã tạo, nhấp vào tab <strong>Configuration</strong>.</p>
</li>
<li>
<p>Trên tab <strong>General Configuration</strong>, nhấp vào <strong>Edit</strong>.</p>
</li>
<li>
<p>Thời gian chờ của <strong>function</strong> cần được kéo dài đến 15 phút để cho phép <strong>Detective</strong> hoàn thành cuộc điều tra. Cập nhật thời gian chờ thành 15 phút và nhấp vào <strong>Save</strong>.</p>
</li>
<li>
<p>Ngay phía trên phần <strong>Code source</strong> cho <strong>Lambda function</strong> bạn đã tạo, nhấp vào tab <strong>Configuration</strong>.</p>
</li>
<li>
<p>Để <strong>function</strong> này hoạt động như mong muốn, bạn sẽ cần thay đổi quyền của <strong>function</strong>. Quyền này cần bao gồm các hành động cần thiết mà bạn đang thực hiện với <strong>Detective</strong> và <strong>Security Hub</strong> trong <strong>function</strong>. Bạn cần thêm một chính sách mới vào vai trò thực thi cho <strong>Lambda function</strong> này. Sau đó nhấp vào <strong>Permissions</strong> từ bảng điều hướng bên trái xuất hiện.</p>
</li>
<li>
<p>Nhấp vào <strong>Role name</strong>. Tên này sẽ bắt đầu bằng &ldquo;InvestigateWithDetective-role-&rdquo;. Điều này sẽ đưa bạn đến vai trò trong <strong>Identity and Access Management (IAM) console</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s12.png"></p>
</li>
<li>
<p>Từ trang <strong>Role</strong>, nhấp vào nút <strong>Add permissions</strong> và chọn <strong>Create inline policy</strong>.</p>
</li>
<li>
<p>Trên trang <strong>Create policy</strong>, nhấp vào tab <strong>JSON</strong>. Sau đó thay thế chính sách hiện tại bằng chính sách sau (không sử dụng chính sách này trong môi trường sản xuất, vì nó không hoàn toàn tuân theo nguyên tắc least privilege và chỉ được dùng làm ví dụ).</p>
</li>
</ol>
<pre tabindex="0"><code>{
    &#34;Version&#34;: &#34;2012-10-17&#34;,
    &#34;Statement&#34;: [
        {
            &#34;Effect&#34;: &#34;Allow&#34;,
            &#34;Action&#34;: [
                &#34;detective:ListGraphs&#34;,
                &#34;detective:searchGraph&#34;,
                &#34;detective:StartInvestigation&#34;,
                &#34;detective:UpdateInvestigationState&#34;,
                &#34;detective:GetInvestigation&#34;,
                &#34;detective:ListInvestigations&#34;,
                &#34;detective:ListIndicators&#34;,
                &#34;securityhub:BatchUpdateFindings&#34;,
                &#34;securityhub:UpdateFindings&#34;
            ],
            &#34;Resource&#34;: &#34;*&#34;
        }
    ]
}
</code></pre><ol start="15">
<li>
<p>Nhấp vào nút <strong>Next</strong>. Nếu bạn thấy một biểu ngữ thông báo <strong>You need permissions</strong>, hãy bỏ qua nó.</p>
</li>
<li>
<p>Đặt tên cho chính sách của bạn là &ldquo;DetectiveSecurityHubIntegration&rdquo; và nhấp vào <strong>Create policy</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s16.png"></p>
</li>
</ol>
<h4 id="set-up-automated-investigations-and-finding-enrichment-with-easy-to-configure-filters">Set up automated investigations and finding enrichment with easy to configure filters</h4>
<p>Bây giờ bạn đã bật <strong>GuardDuty</strong>, <strong>Security Hub</strong>, và <strong>Detective</strong> (điều này đã được thực hiện cho bạn) và đã thiết lập <strong>Lambda function</strong>, bạn đã sẵn sàng thiết lập hai phương pháp khởi tạo các cuộc điều tra. Phương pháp đầu tiên liên quan đến việc tự động điều tra và làm giàu các <strong>GuardDuty findings</strong> có mức độ nghiêm trọng <strong>HIGH</strong> và <strong>MEDIUM</strong>. Điều này sẽ tăng tốc quá trình điều tra cho các <strong>findings</strong> có mức độ nghiêm trọng cao nhất vì bạn không cần phải vào <strong>Security Hub</strong> hoặc <strong>Detective</strong> và chọn thủ công các <strong>findings</strong> để điều tra.</p>
<p>Trong phương pháp này, bạn sẽ khởi tạo <strong>Lambda function</strong> mà bạn đã thiết lập trước đó bằng cách sử dụng <strong>Security Hub Automations</strong> và một <strong>EventBridge Rule</strong>. Sử dụng <strong>Security Hub Automations</strong> cho phép bạn cấu hình và cập nhật các <strong>findings</strong> nào được tự động điều tra và làm giàu mà không cần thay đổi mã liên tục (các quy tắc tự động hóa sử dụng giao diện người dùng với các tùy chọn thả xuống cho tiêu chí).</p>
<ol start="17">
<li>
<p>Mở <strong>Security Hub</strong> và đi đến <a href="https://us-east-1.console.aws.amazon.com/securityhub/home?region=us-east-1#/automation-rule">Automations page</a>.</p>
</li>
<li>
<p>Nhấp vào <strong>Create rule</strong>.</p>
</li>
<li>
<p>Chọn <strong>Create custom rule</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s19.png"></p>
</li>
<li>
<p>Đặt tên cho quy tắc của bạn là &ldquo;Automated Investigation&rdquo; và cung cấp mô tả cho quy tắc.</p>
</li>
<li>
<p>Dưới phần <strong>Criteria</strong>, chọn <strong>ProductName</strong> cho <strong>Key</strong>, <strong>Equals</strong> cho <strong>Operator</strong>, và nhập &ldquo;GuardDuty&rdquo; cho <strong>Value</strong>.</p>
</li>
<li>
<p>Nhấp vào <strong>Add criteria</strong>.</p>
</li>
<li>
<p>Đối với tiêu chí thứ hai, chọn <strong>SeverityLabel</strong> cho <strong>Key</strong>, <strong>Equals</strong> cho <strong>Operator</strong>, và <strong>HIGH</strong> cho <strong>Value</strong>.</p>
</li>
<li>
<p>Sau đó, dưới tiêu chí đó, nhấp vào văn bản <strong>Add another value</strong>. Lần này, chọn <strong>Equals</strong> cho <strong>Operator</strong> và <strong>MEDIUM</strong> cho <strong>Value</strong>.</p>
</li>
<li>
<p>Nhấp vào <strong>Add criteria</strong> lần thứ ba. Lần này, chọn <strong>ResourceType</strong> cho <strong>Key</strong>, <strong>Equals</strong> cho <strong>Operator</strong>, và nhập &ldquo;AwsIamAccessKey&rdquo; cho <strong>Value</strong> (phân biệt chữ hoa chữ thường).</p>
</li>
<li>
<p>Dưới tiêu chí <strong>ResourceType</strong>, nhấp vào <strong>Add another value</strong> hai lần để thêm hai giá trị nữa. Sử dụng <strong>operator</strong> là <strong>Equals</strong> cho cả hai. Sau đó, sử dụng các giá trị &ldquo;AwsIamUser&rdquo; và &ldquo;AwsIamRole&rdquo; tương ứng. Đảm bảo rằng phần <strong>Criteria</strong> khớp với ảnh chụp màn hình bên dưới.</p>
</li>
<li>
<p>Cuộn xuống phần <strong>Automated action</strong> và nhấp vào <strong>Add another key-value pair</strong>. Đây là cách bạn sẽ thiết lập một trường do người dùng xác định để gắn cờ các <strong>findings</strong> mà bạn muốn tự động điều tra.</p>
</li>
<li>
<p>Đối với <strong>Key</strong>, nhập &ldquo;investigate&rdquo;, và đối với <strong>Value</strong>, nhập &ldquo;true&rdquo;. Giữ nguyên tất cả các trường khác.</p>
</li>
<li>
<p>Ở cuối trang, nhấp vào <strong>Create rule</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s28.png"></p>
</li>
<li>
<p>Tiếp theo, bạn cần thiết lập một <strong>EventBridge Rule</strong> để xác định những <strong>findings</strong> nào được điều tra dựa trên trường do người dùng xác định. Bạn có thể sử dụng một quy tắc duy nhất trong <strong>Amazon EventBridge</strong>. Trong trường hợp này, <strong>EventBridge Rule</strong> sẽ tìm kiếm <strong>Security Hub Findings - Imported</strong>. Mỗi sự kiện <strong>Security Hub Findings - Imported</strong> chứa một <strong>finding</strong> duy nhất. Tuy nhiên, bạn chỉ muốn khớp với các <strong>findings</strong> có chứa trường do người dùng xác định, &ldquo;investigate&rdquo;. Điều hướng đến <a href="https://us-east-1.console.aws.amazon.com/events/home?region=us-east-1#/">EventBridge</a>.</p>
</li>
<li>
<p>Nhấp vào <strong>Create rule</strong> dưới phần <strong>Get started</strong> (với <strong>EventBridge Rule</strong> được chọn).</p>
</li>
<li>
<p>Trên trang <strong>Define rule detail</strong>, đặt tên và mô tả cho quy tắc của bạn. Đối với <strong>Name</strong>, nhập &ldquo;AutomatedInvestigation&rdquo;. Sau đó nhấp vào <strong>Next</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s31.png"></p>
</li>
<li>
<p>Ở bước <strong>Build event pattern</strong>, cuộn xuống <strong>Event pattern</strong>. Chọn phương pháp <strong>Custom pattern (JSON editor)</strong>.
Sao chép và dán JSON sau vào trường <strong>Event pattern</strong>.</p>
</li>
</ol>
<pre tabindex="0"><code>{
  &#34;source&#34;: [&#34;aws.securityhub&#34;],
  &#34;detail&#34;: {
    &#34;findings&#34;: {
      &#34;UserDefinedFields&#34;: {
        &#34;investigate&#34;: [&#34;true&#34;]
      }
    }
  }
}
</code></pre><ol start="34">
<li>
<p>Nhấp vào <strong>Next</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s34.png"></p>
</li>
<li>
<p>Ở bước <strong>Select target(s)</strong>, chọn <strong>Lambda function</strong> từ danh sách thả xuống <strong>Select a target</strong>. Sau đó chọn <strong>InvestigateWithDetective</strong> từ danh sách thả xuống <strong>Function</strong>.</p>
</li>
<li>
<p>Nhấp vào <strong>Next</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s36.png"></p>
</li>
<li>
<p>Ở bước <strong>Configure tags</strong>, nhấp vào <strong>Next</strong>.</p>
</li>
<li>
<p>Ở bước <strong>Review and create</strong>, nhấp vào <strong>Create rule</strong>. Khi các <strong>findings</strong> mới được tổng hợp trong <strong>Security Hub</strong>, chúng sẽ được đánh giá và cập nhật bởi quy tắc tự động hóa. Bất kỳ <strong>findings</strong> nào nhận được trường do người dùng xác định sẽ kích hoạt <strong>Lambda function</strong>. Sau khi khởi tạo <strong>Lambda</strong>, quá trình thực thi có thể mất vài phút để hoàn thành và xuất hiện trong <strong>Security Hub</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s38.png"></p>
</li>
</ol>

<div class="notices warning" ><p><strong>Lưu ý cho Người Tham Gia</strong>: Có thể mất một khoảng thời gian trước khi một <strong>finding</strong> được cập nhật hoặc tạo mới, điều này sẽ kích hoạt tự động hóa này. Tiếp tục theo hướng dẫn và thực hiện các bước tiếp theo. Trong phần tiếp theo, bạn sẽ thiết lập quy trình khởi tạo cuộc điều tra và làm giàu <strong>finding</strong> theo yêu cầu.</p>
</div>

<h4 id="set-up-on-demand-finding-investigation-and-enrichment">Set up on-demand finding investigation and enrichment</h4>
<p>Phương pháp thứ hai liên quan đến việc điều tra và làm giàu <strong>findings</strong> theo yêu cầu. Bạn có thể muốn sử dụng cả hai phương pháp trong trường hợp có những <strong>findings</strong> không đáp ứng tiêu chí của quy tắc tự động hóa trước đó mà bạn vẫn muốn điều tra.</p>
<ol start="39">
<li>
<p>Trong phương pháp này, bạn sẽ khởi tạo cùng một <strong>Lambda function</strong> thông qua việc sử dụng tính năng <strong>Custom Actions</strong> trong <strong>Security Hub</strong>. Mở <strong>Security Hub</strong> và truy cập trang <a href="https://us-east-1.console.aws.amazon.com/securityhub/home?region=us-east-1#/settings/actions">Custom actions</a>.</p>
</li>
<li>
<p>Nhấp vào <strong>Create custom action</strong>.</p>
</li>
<li>
<p>Đối với <strong>Action name</strong>, nhập &ldquo;Investigate&rdquo;. Đối với <strong>Action Description</strong>, nhập &ldquo;Investigate with Detective&rdquo;. Đối với <strong>Action ID</strong>, nhập &ldquo;investigate&rdquo;.</p>
</li>
<li>
<p>Nhấp vào <strong>Create custom action</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s42.png"></p>
</li>
<li>
<p>Sao chép <strong>Custom action ARN</strong> đã được tạo cho <strong>finding</strong> tùy chỉnh của bạn. Bạn sẽ cần nó trong một vài bước tiếp theo.</p>
</li>
<li>
<p>Tiếp theo, bạn cần tạo một quy tắc khác trong <strong>EventBridge</strong>, nhưng lần này nó sẽ khớp với các sự kiện cho <strong>custom action</strong> của bạn. Điều hướng đến <a href="https://us-east-1.console.aws.amazon.com/events/home?region=us-east-1#/">EventBridge</a>.</p>
</li>
<li>
<p>Nhấp vào <strong>Create rule</strong> dưới phần <strong>Get started</strong> (với <strong>EventBridge Rule</strong> đã được chọn).</p>
</li>
<li>
<p>Trên trang <strong>Define rule detail</strong>, đặt tên và mô tả cho quy tắc của bạn. Đối với <strong>Name</strong>, nhập &ldquo;InitiatedAutomatedInvestigation&rdquo;. Sau đó nhấp vào <strong>Next</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s46.png"></p>
</li>
<li>
<p>Ở bước <strong>Build event pattern</strong>, cuộn xuống <strong>Event Pattern</strong>. Để <strong>Event source</strong> được đặt là <strong>AWS Services</strong>. Cuộn xuống <strong>Event pattern</strong>. Dưới <strong>Event source</strong>, chọn <strong>Security Hub</strong>.</p>
</li>
<li>
<p>Đối với <strong>Event Type</strong>, chọn <strong>Security Hub Findings – Custom Action</strong>.</p>
</li>
<li>
<p>Sau đó chọn nút radio <strong>Specific custom action ARN(s)</strong> và nhập <strong>ARN</strong> cho <strong>custom action</strong> mà bạn đã tạo trước đó.</p>
</li>
<li>
<p>Nhấp vào <strong>Next</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s50.png"></p>
</li>
<li>
<p>Ở bước <strong>Select target(s)</strong>, chọn <strong>Lambda function</strong> từ danh sách thả xuống <strong>Select a target</strong>. Sau đó chọn <strong>InvestigateWithDetective</strong> từ danh sách thả xuống <strong>Function</strong>.</p>
</li>
<li>
<p>Nhấp vào <strong>Next</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s52.png"></p>
</li>
<li>
<p>Ở bước <strong>Configure tags</strong>, nhấp vào <strong>Next</strong>.</p>
</li>
<li>
<p>Ở bước <strong>Review and create</strong>, nhấp vào <strong>Create rule</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s54.png"></p>
</li>
</ol>
<h4 id="initiate-an-on-demand-finding-investigation">Initiate an on-demand finding investigation</h4>
<ol start="55">
<li>
<p>Quay lại <strong>Security Hub</strong>. Mở trang <strong>Findings</strong>.</p>
</li>
<li>
<p>Trong ô <strong>Add filter input</strong>, thêm một bộ lọc cho <strong>Resource Type</strong>. Đặt bộ lọc thành <strong>Resource Type is AwsIamAccessKey</strong> (phân biệt chữ hoa chữ thường). Nhấp vào <strong>Apply</strong>.</p>
</li>
<li>
<p>Trong ô <strong>Add filter input</strong>, thêm một bộ lọc cho <strong>Product Name</strong>. Đặt bộ lọc thành <strong>Product Name is GuardDuty</strong> (phân biệt chữ hoa chữ thường). Nhấp vào <strong>Apply</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s56.png"></p>
</li>
<li>
<p>Nhấp vào tiêu đề của một <strong>finding</strong> trong danh sách và kiểm tra xem có bất kỳ <strong>Notes</strong> nào không. Nếu có, hãy mở rộng phần đó và xem nội dung của <strong>notes</strong> (nếu có, bạn có thể xác định <strong>note</strong> đến từ đâu không?). Lưu ý:
<img alt="VPC" src="//localhost:1313/images/5/5.5/s57.png"></p>
</li>
<li>
<p>Đừng chọn <strong>finding</strong> liên quan đến <strong>RegisterManagedInstance</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s58.png"></p>
</li>
<li>
<p>Nhấp vào hộp kiểm bên trái của <strong>finding</strong> này để chọn nó.</p>
</li>
<li>
<p>Trong menu thả xuống <strong>Actions</strong>, chọn <strong>custom action</strong> mới của bạn (Investigate).
<img alt="VPC" src="//localhost:1313/images/5/5.5/s60.png">
Chọn một <strong>finding</strong> khác để điều tra:
<img alt="VPC" src="//localhost:1313/images/5/5.5/s60b.png">
Sau 3 phút:
<img alt="VPC" src="//localhost:1313/images/5/5.5/s60c.png"></p>
</li>
<li>
<p>Quá trình điều tra có thể mất tới 15 phút để hoàn thành. Làm mới trang sau mỗi vài phút cho đến khi <strong>finding</strong> có một phần <strong>Notes</strong> mới trong chi tiết. Nhấp vào tiêu đề của <strong>finding</strong> đó và mở rộng phần <strong>Notes</strong>.
Chờ sau 5 phút để thấy cập nhật <strong>node</strong>:
<img alt="VPC" src="//localhost:1313/images/5/5.5/s61.png"></p>
</li>
<li>
<p>Bạn cũng có thể chuyển sang tab <strong>History</strong> trong chi tiết <strong>finding</strong> để xem sự kiện được đánh dấu thời gian với thay đổi <strong>Note</strong>.</p>
</li>
</ol>
<h4 id="surface-investigated-findings-in-a-custom-insight">Surface investigated findings in a custom insight</h4>
<ol start="63">
<li>
<p>Nếu bạn muốn dễ dàng theo dõi tài nguyên và <strong>findings</strong> đã được điều tra thông qua bất kỳ phương pháp nào mà bạn đã triển khai, hãy tạo một <strong>custom insight</strong> mới trong <strong>Security Hub</strong>. Mở <strong>Security Hub</strong> và truy cập trang <a href="https://us-east-1.console.aws.amazon.com/securityhub/home?region=us-east-1#/insights">Insights</a>.</p>
</li>
<li>
<p>Nhấp vào <strong>Create insight</strong>.</p>
</li>
<li>
<p>Nhấp vào trường ghi &ldquo;Add filter&rdquo; ở đầu trang và chọn <strong>User defined fields</strong>.</p>
</li>
<li>
<p>Đặt <strong>Key</strong> là <strong>investigate</strong> và <strong>Value</strong> là <strong>complete</strong>. Điều này sẽ lọc danh sách <strong>findings</strong> chỉ bao gồm những <strong>findings</strong> đã được làm giàu thành công. Nhấp vào <strong>Apply</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s66.png">
Kết quả:
<img alt="VPC" src="//localhost:1313/images/5/5.5/s66b.png"></p>
</li>
<li>
<p>Nhấp vào trường ghi &ldquo;Add filter&rdquo; ở đầu trang một lần nữa và chọn <strong>GroupBy</strong>. Sau đó chọn <strong>Resource ID</strong>. Nhấp vào <strong>Apply</strong>.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s67.png"></p>
</li>
<li>
<p><strong>Insight</strong> hiện đang hiển thị danh sách các tài nguyên và số lượng <strong>findings</strong> đang hoạt động, liên quan đến tài nguyên đó đã được điều tra và làm giàu.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s68.png"></p>
</li>
<li>
<p>Nhấp vào <strong>Create insight</strong>. Đặt tên cho <strong>insight</strong> của bạn là &ldquo;Investigated Resources&rdquo; và nhấp vào <strong>Create insight</strong> một lần nữa.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s69.png"></p>
</li>
<li>
<p>Ở đầu trang, nhấp vào <strong>Insight details</strong> để xem các biểu đồ cho <strong>insight</strong> mới.
<img alt="VPC" src="//localhost:1313/images/5/5.5/s70.png"></p>
</li>
</ol>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="//localhost:1313/vi/5/5.4/" title="Building your own automated response"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="//localhost:1313/vi/6/" title="Mô phỏng và kịch bản bảo mật" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="//localhost:1313/js/clipboard.min.js?1724174125"></script>
    <script src="//localhost:1313/js/perfect-scrollbar.min.js?1724174125"></script>
    <script src="//localhost:1313/js/perfect-scrollbar.jquery.min.js?1724174125"></script>
    <script src="//localhost:1313/js/jquery.sticky.js?1724174125"></script>
    <script src="//localhost:1313/js/featherlight.min.js?1724174125"></script>
    <script src="//localhost:1313/js/highlight.pack.js?1724174125"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="//localhost:1313/js/modernizr.custom-3.6.0.js?1724174125"></script>
    <script src="//localhost:1313/js/learn.js?1724174125"></script>
    <script src="//localhost:1313/js/hugo-learn.js?1724174125"></script>

    <link href="//localhost:1313/mermaid/mermaid.css?1724174125" rel="stylesheet" />
    <script src="//localhost:1313/mermaid/mermaid.js?1724174125"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
