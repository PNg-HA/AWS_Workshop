<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.128.2">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="//localhost:1313/images/favicon.png" type="image/png">

    <title>Set up a weekly vulnerability summary email :: AWS System Manager</title>

    
    <link href="//localhost:1313/css/nucleus.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/fontawesome-all.min.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/hybrid.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/featherlight.min.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/perfect-scrollbar.min.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/auto-complete.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/atom-one-dark-reasonable.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/theme.css?1724174124" rel="stylesheet">
    <link href="//localhost:1313/css/hugo-theme.css?1724174124" rel="stylesheet">
    
    <link href="//localhost:1313/css/theme-workshop.css?1724174124" rel="stylesheet">
    
    

    <script src="//localhost:1313/js/jquery-3.3.1.min.js?1724174124"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="//localhost:1313/5/5.2/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="//localhost:1313/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="//localhost:1313/js/lunr.min.js?1724174124"></script>
<script type="text/javascript" src="//localhost:1313/js/auto-complete.js?1724174124"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/localhost:1313\/";
    
</script>
<script type="text/javascript" src="//localhost:1313/js/search.js?1724174124"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-workshop-instructions/" title="Workshop Instructions" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/1-workshop-instructions/">
           <b> 1. </b> Workshop Instructions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/" title="Introduction to threat detection and response services " class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/">
           <b> 2. </b> Introduction to threat detection and response services 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/" title="AWS Security Hub" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/">
           <b> 2.1 </b> AWS Security Hub
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.1-security-hub-overview/" title="Security Hub - Overview" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.1-security-hub-overview/">
           <b> 2.1.1 </b> Security Hub - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.2-security-hub-dashboard/" title="Security Hub - Dashboard" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.2-security-hub-dashboard/">
           <b> 2.1.2 </b> Security Hub - Dashboard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.3-security-hub-findings/" title="Security Hub - Findings" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.3-security-hub-findings/">
           <b> 2.1.3 </b> Security Hub - Findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.4-security-hub-pricing/" title="Security Hub - Pricing" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.4-security-hub-pricing/">
           <b> 2.1.4 </b> Security Hub - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.5-security-hub-notifications/" title="Security Hub - Notifications" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.5-security-hub-notifications/">
           <b> 2.1.5 </b> Security Hub - Notifications
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/" title="Amazon GuardDuty" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/">
           <b> 2.2 </b> Amazon GuardDuty
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.1-guardduty-overview/" title="GuardDuty - Overview" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.1-guardduty-overview/">
           <b> 2.2.1 </b> GuardDuty - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.2-guardduty-findings/" title="GuardDuty - Findings" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.2-guardduty-findings/">
           <b> 2.2.2 </b> GuardDuty - Findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.3-guardduty-protection-plans/" title="GuardDuty - Protection plans" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.3-guardduty-protection-plans/">
           <b> 2.2.3 </b> GuardDuty - Protection plans
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.4-guardduty-building-your-own-threat-list/" title="GuardDuty - Building your own threat list" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.4-guardduty-building-your-own-threat-list/">
           <b> 2.2.4 </b> GuardDuty - Building your own threat list
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.5-guardduty-suppressing-findings/" title="GuardDuty - Suppressing findings" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.5-guardduty-suppressing-findings/">
           <b> 2.2.5 </b> GuardDuty - Suppressing findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.6-guradduty-pricing/" title="GuradDuty - Pricing" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.6-guradduty-pricing/">
           <b> 2.2.6 </b> GuradDuty - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.7-guardduty-notifications/" title="GuardDuty - Notifications" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.7-guardduty-notifications/">
           <b> 2.2.7 </b> GuardDuty - Notifications
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.8-guardduty-retaining-findings/" title="GuardDuty - Retaining findings" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.8-guardduty-retaining-findings/">
           <b> 2.2.8 </b> GuardDuty - Retaining findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/" title="Amazon Inspector" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/">
           <b> 2.3 </b> Amazon Inspector
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.1-inspector-overview/" title="Inspector - Overview" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.1-inspector-overview/">
           <b> 2.3.1 </b> Inspector - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.2-inspector-dashboard/" title="Inspector - Dashboard" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.2-inspector-dashboard/">
           <b> 2.3.2 </b> Inspector - Dashboard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.3-inspector-findings/" title="Inspector  - Findings" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.3-inspector-findings/">
           <b> 2.3.3 </b> Inspector  - Findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.4-inspector-vulnerability-database-search/" title="Inspector - Vulnerability database search" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.4-inspector-vulnerability-database-search/">
           <b> 2.3.4 </b> Inspector - Vulnerability database search
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.5-inspector-suppressing-findings/" title="Inspector - Suppressing findings" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.5-inspector-suppressing-findings/">
           <b> 2.3.5 </b> Inspector - Suppressing findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.6-inspector-pricing/" title="Inspector - Pricing" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.6-inspector-pricing/">
           <b> 2.3.6 </b> Inspector - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/" title="Amazon Detective" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/">
           <b> 2.4 </b> Amazon Detective
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.1-detective-overview/" title="Detective - Overview" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.1-detective-overview/">
           <b> 2.4.1 </b> Detective - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.2-detective-summary/" title="Detective - Summary" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.2-detective-summary/">
           <b> 2.4.2 </b> Detective - Summary
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.3-detective-search/" title="Detective - Search" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.3-detective-search/">
           <b> 2.4.3 </b> Detective - Search
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.4-detective-investigations/" title="Detective - Investigations" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.4-detective-investigations/">
           <b> 2.4.4 </b> Detective - Investigations
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.5-detective-finding-groups/" title="Detective - Finding Groups" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.5-detective-finding-groups/">
           <b> 2.4.5 </b> Detective - Finding Groups
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.6-detective-pricing/" title="Detective - Pricing" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.6-detective-pricing/">
           <b> 2.4.6 </b> Detective - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.7-detective-eks-audit-logs/" title="Detective - EKS Audit Logs" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.7-detective-eks-audit-logs/">
           <b> 2.4.7 </b> Detective - EKS Audit Logs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3/" title="Integrating AWS Services and Partner Solutions" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/3/">
           <b> 3. </b> Integrating AWS Services and Partner Solutions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3/3.1/" title="Centralizing findings from AWS security services" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/3/3.1/">
           <b> 3.1. </b> Centralizing findings from AWS security services
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.2/" title="Aggregating findings from multiple AWS accounts" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/3/3.2/">
           <b> 3.2. </b> Aggregating findings from multiple AWS accounts
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.3/" title="Centralizing findings from AWS partner solutions" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/3/3.3/">
           <b> 3.3. </b> Centralizing findings from AWS partner solutions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.4/" title="Cross-region finding aggregation" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/3/3.4/">
           <b> 3.4. </b> Cross-region finding aggregation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.5/" title="Building your own Security Hub integration" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/3/3.5/">
           <b> 3.5. </b> Building your own Security Hub integration
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4/" title="Managing and Prioritizing Security Findings" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/4/">
           <b> 4. </b> Managing and Prioritizing Security Findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/4/4.1/" title="Prioritizing findings at scale with automations" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/4/4.1/">
           <b> 4.1 </b> Prioritizing findings at scale with automations
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4/4.2/" title="Suppressing findings at scale with automations" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/4/4.2/">
           <b> 4.2 </b> Suppressing findings at scale with automations
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4/4.3/" title="Using insights for prioritization and metrics" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/4/4.3/">
           <b> 4.3 </b> Using insights for prioritization and metrics
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5/" title="Automating Notifications and Response" class="dd-item 
        parent
        
        
        ">
      <a href="//localhost:1313/5/">
           <b> 5. </b> Automating Notifications and Response
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/5/5.1/" title="Setting up notifications" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/5/5.1/">
           <b> 5.1 </b> Setting up notifications
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5/5.2/" title="Set up a weekly vulnerability summary email" class="dd-item 
        
        active
        
        ">
      <a href="//localhost:1313/5/5.2/">
           <b> 5.2 </b> Set up a weekly vulnerability summary email
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5/5.3/" title="Automated Security Response on AWS" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/5/5.3/">
           <b> 5.3 </b> Automated Security Response on AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5/5.4/" title="Building your own automated response" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/5/5.4/">
           <b> 5.4 </b> Building your own automated response
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/5/5.5/" title="Enriching security findings with investigative data" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/5/5.5/">
           <b> 5.5 </b> Enriching security findings with investigative data
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6/" title="Security Simulations and Scenarios" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/6/">
           <b> 6. </b> Security Simulations and Scenarios
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/6/6.1/" title="Respond to IAM Role credential exfiltration" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/6/6.1/">
           <b> 6.1 </b> Respond to IAM Role credential exfiltration
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6/6.2/" title="Respond to a compromised S3 Bucket" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/6/6.2/">
           <b> 6.2 </b> Respond to a compromised S3 Bucket
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6/6.3/" title="Respond to compromised IAM credentials" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/6/6.3/">
           <b> 6.3 </b> Respond to compromised IAM credentials
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6/6.4/" title="Respond to a Lambda function calling malicious IP" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/6/6.4/">
           <b> 6.4 </b> Respond to a Lambda function calling malicious IP
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6/6.5/" title="Respond to Malware on Amazon Elastic Block Store" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/6/6.5/">
           <b> 6.5 </b> Respond to Malware on Amazon Elastic Block Store
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6/6.6/" title="Respond to Malware on Amazon Elastic Block Store" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/6/6.6/">
           <b> 6.5 </b> Respond to Malware on Amazon Elastic Block Store
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7/" title="Software Vulnerability Management" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/7/">
           <b> 7. </b> Software Vulnerability Management
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/7/7.1/" title="Patching EC2 with Patch Manager" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/7/7.1/">
           <b> 7.1 </b> Patching EC2 with Patch Manager
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/7/7.2/" title="Vulnerability management for serverless applications" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/7/7.2/">
           <b> 7.2 </b> Vulnerability management for serverless applications
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/7/7.3/" title="Integrating Amazon Inspector into a CI/CD pipeline" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/7/7.3/">
           <b> 7.3 </b> Integrating Amazon Inspector into a CI/CD pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/8/" title="Clean up resources" class="dd-item 
        
        
        
        ">
      <a href="//localhost:1313/8/">
          <b>8. </b>Clean up resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="//localhost:1313/5/5.2/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="//localhost:1313/vi/5/5.2/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>19-08-2024</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Author </b> <br>
           
            <i><a href="https://www.linkedin.com/in/anhpnh"  style="color:orange">Hải Anh </a> <br>
                
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='//localhost:1313/'>Threat Detection & Response Workshop</a> > <a href='//localhost:1313/5/'>Automating Notifications and Response</a> > Set up a weekly vulnerability summary email
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Set up a weekly vulnerability summary email
            </h1>
          

        



	
<div class="notices info" ><p><strong>Scenario / Problem Statement</strong>: You have been tasked with setting up a weekly summary email to highlight key insights based on the data you are aggregating in Security Hub. As a starting point, the email needs to highlight your current security store, the vulnerabilities impacting the most instances and images, and the highest priority findings.</p>
</div>


<div class="notices warning" ><p><strong>Note to Participants</strong>: You must complete the module named &ldquo;Using insights for prioritization and metrics&rdquo; before starting this module.</p>
</div>

<p>In this scenario, you&rsquo;ll write a Lambda function to call the Security Hub and Amazon Inspector APIs to fetch the details we need. you&rsquo;ll use EventBridge to call the Lambda weekly, and you will subscribe to the email by using AWS Simple Notification Service.</p>
<p>Amazon Inspector is an automated vulnerability management service that continually scans AWS workloads for software vulnerabilities and unintended network exposure. Vulnerability findings from Inspector are included in the summary email to provide a more comprehensive view of vulnerabilities that may exist in the account that the summary email is being produced for.</p>
<h4 id="configure-amazon-simple-notification-service-topic">Configure Amazon Simple Notification Service topic</h4>
<ol>
<li>
<p>Navigate to <a href="https://console.aws.amazon.com/sns/v3/home">Amazon SNS</a></p>
</li>
<li>
<p>Click <strong>Topics</strong> in the left navigation.</p>
</li>
<li>
<p>Click <strong>Create topic</strong>.</p>
</li>
<li>
<p>Select <strong>Standard</strong> type.</p>
</li>
<li>
<p>For the name, enter weekly-vulnerability-email. Leave everything else as is and click <strong>Create topic</strong> at the bottom of the page. This will create the topic.</p>
</li>
<li>
<p>Make a note of the SNS Topic <strong>ARN</strong>. You will need this later. The ARN looks like &ldquo;arn:aws:sns:us-******:############:weekly-vulnerability-email&rdquo;.</p>
</li>
</ol>
<h4 id="subscribe-to-the-topic">Subscribe to the topic</h4>
<ol start="7">
<li>
<p>From the <strong>weekly-vulnerability-email</strong> topic page, click <strong>Create subscription</strong>.</p>
</li>
<li>
<p>On the <strong>Create subscription</strong> page, under <strong>Protocol</strong>, select <strong>email</strong>.</p>
</li>
<li>
<p>On the <strong>Create subscription</strong> page, under <strong>Endpoint</strong>, enter your email address that you want to use for this workshop to receive notifications. You can unsubscribe at the end of the workshop.</p>
</li>
<li>
<p>Click <strong>Create subscription</strong>.</p>
</li>
<li>
<p>Within a couple minutes, you will receive an email at the email address you entered. Confirm the subscription by clicking &ldquo;Confirm subscription&rdquo; in the email.</p>
</li>
</ol>
<h4 id="create-the-lambda-function-to-author-the-email">Create the Lambda function to author the email</h4>
<ol start="12">
<li>
<p>Go to <a href="https://console.aws.amazon.com/lambda/home?#/create/function?intent=authorFromScratch">https://console.aws.amazon.com/lambda/home?#/create/function?intent=authorFromScratch</a>
On the <strong>Create function</strong> page, set the <strong>Function name</strong> to <strong>weekly-vulnerability-email</strong> and pick <strong>Node.js 20.x</strong> for the <strong>Runtime</strong>.</p>
</li>
<li>
<p>Click <strong>Create function</strong>.
Copy and paste the following code into the editor labeled <strong>Code source</strong> (removing the existing code).</p>
</li>
</ol>
<pre tabindex="0"><code>&#39;use strict&#39;;
import {
    SecurityHubClient,
    GetInsightsCommand,
    GetInsightResultsCommand
} from &#34;@aws-sdk/client-securityhub&#34;;

import {
    Inspector2Client,
    ListFindingAggregationsCommand
} from &#34;@aws-sdk/client-inspector2&#34;;

import {
    SNSClient,
    PublishCommand
} from &#34;@aws-sdk/client-sns&#34;;

const securityhubClient = new SecurityHubClient();
const inspectorClient = new Inspector2Client();
const snsClient = new SNSClient();

export const handler = async (event, context) =&gt; {
    try {
        let msg = &#39;&#39;;
        const getInsights = new GetInsightsCommand({});
        const allCustomInsights = await securityhubClient.send(getInsights);
        const insightsToFetch = [
            ...allCustomInsights.Insights, // include all custom insights
            ...[
                {
                    Name: &#34;Top products by counts of findings&#34;,
                    InsightArn: &#34;arn:aws:securityhub:::insight/securityhub/default/28&#34;
                }, // include default insight 28
                {
                    Name: &#34;Severity by counts of findings&#34;,
                    InsightArn: &#34;arn:aws:securityhub:::insight/securityhub/default/29&#34;
                } // include default insight 29
            ]
        ];

        const insightsToFetchResults = await Promise.all(insightsToFetch.map(async (o, i) =&gt; {
            let getInsightResults = new GetInsightResultsCommand({InsightArn: o.InsightArn});
            let insightResults = await securityhubClient.send(getInsightResults);
            return {...insightResults, Name: o.Name};
        }));
        
        const results = insightsToFetchResults.forEach((o,i) =&gt; {
            msg += `------------------------------------\nInsight: ${o.Name}\n------------------------------------\n`;
            o.InsightResults.ResultValues.slice(0,9).forEach((o,i) =&gt; {
                msg += `${o.GroupByAttributeValue}: ${o.Count}\n`;
            }); 
            msg += `\nFollow the link below to see all ${o.InsightResults.ResultValues.length} results from this insight in Security Hub:\n`;
            msg += `https://us-east-1.console.aws.amazon.com/securityhub/home?region=us-east-1#/insights/${o.InsightResults.InsightArn}\n\n`;
        });

        const listFindingAggregationsInput = {
            &#34;aggregationType&#34;: &#34;PACKAGE&#34;,
            &#34;maxResults&#34;: 5,
            &#34;aggregationRequest&#34;: {
                &#34;packageAggregation&#34;: {
                    &#34;sortOrder&#34;: &#34;DESC&#34;,
                    &#34;sortBy&#34;: &#34;CRITICAL&#34;
                }
            }
        };
        const listFindingAggregations = new ListFindingAggregationsCommand(listFindingAggregationsInput);
        const inspectorFindingAggregations = await inspectorClient.send(listFindingAggregations);
        msg += &#39;\n------------------------------------\nSoftware vulnerabilities impacting the most instances and images:\n------------------------------------\n&#39;;
        inspectorFindingAggregations.responses.forEach(pkg =&gt; {
            msg += `Package: ${pkg.packageAggregation.packageName}:\nCounts of findings by severity:\n`;
            msg += `Critical: ${pkg.packageAggregation.severityCounts.critical}, `;
            msg += `High: ${pkg.packageAggregation.severityCounts.high}, `;
            msg += `Medium: ${pkg.packageAggregation.severityCounts.medium} \n\n`;
        });

        const emailTopicArn = process.env[&#39;emailTopicArn&#39;];
        const messageInput = {
            TopicArn: emailTopicArn,
            Message: msg,
            Subject: &#34;Weekly Vulnerability Report&#34;,
        };
        const publish = new PublishCommand(messageInput);
        const publishResponse = await snsClient.send(publish);

        return `Successfully sent message id ${publishResponse.MessageId}`;
    } catch (error) {
        console.error(&#39;Error:&#39;, error);
        throw error;
    }
}
</code></pre><ol start="16">
<li>
<p>Then from the <strong>Code source</strong> menu, click <strong>File</strong> then <strong>Save</strong>. Then click the <strong>Deploy</strong> button.</p>
</li>
<li>
<p>Notice on line 76 of the Lambda code we reference an environment variable where we store the ARN of the SNS Topic. We need to configure that. Directly above the <strong>Code source</strong> section, click the <strong>Configuration</strong> tab. Then click <strong>Environment Variables</strong> from the left navigation appears.</p>
</li>
<li>
<p>Click <strong>Edit</strong> under <strong>Environment Variables</strong>. Then click <strong>Add environment variable</strong>.</p>
</li>
<li>
<p>Input &ldquo;<strong>emailTopicArn</strong>&rdquo; under <strong>Key</strong>. Input the ARN of the SNS Topic that you created in step 6 as the <strong>Value</strong>. Make sure there are no spaces.</p>
</li>
</ol>
<p>20.Click <strong>Save</strong>.</p>
<h4 id="set-the-permissions-of-the-lambda-function">Set the permissions of the Lambda function</h4>
<ol start="21">
<li>
<p>Now we need to configure the permissions of our Lambda function so it can run the commands required to send our email. Under the same <strong>Configuration</strong> tab, click <strong>Permissions</strong> from the left navigation. We need to modify the execution role for this Lambda function.</p>
</li>
<li>
<p>Click the <strong>Role name</strong>. It should start with &ldquo;weekly-vulnerability-email-role-&rdquo;. This will take you to the role in the Identity and Access Management (IAM) console.</p>
</li>
<li>
<p>From the Role page, click the <strong>Add permissions</strong> button and select <strong>Create inline policy</strong>.</p>
</li>
<li>
<p>On the <strong>Create policy</strong> page, click the <strong>JSON</strong> tab. Then replace the existing policy with the following policy. This policy gives the lambda function permissions to retrieve information about Security Hub insights, retrieve vulnerability findings from Inspector, and the ability to send messages to SNS. For this workshop, we will simply allow our Lambda function to publish to any SNS topic, but in any other environment, it is best practice to limit this to specific ARNs.</p>
</li>
</ol>
<pre tabindex="0"><code>{
	&#34;Version&#34;: &#34;2012-10-17&#34;,
	&#34;Statement&#34;: [
		{
			&#34;Effect&#34;: &#34;Allow&#34;,
			&#34;Action&#34;: [
				&#34;securityhub:GetInsightResults&#34;,
				&#34;securityhub:GetInsightFindingTrend&#34;,
				&#34;inspector2:ListFindingAggregations&#34;,
				&#34;sns:Publish&#34;,
				&#34;securityhub:GetInsights&#34;
			],
			&#34;Resource&#34;: &#34;*&#34;
		}
	]
}
</code></pre><ol start="25">
<li>
<p>Click the <strong>Next</strong> button.</p>
</li>
<li>
<p>Give your policy the name <em>AllowSNSPublishAndInspectorList</em> and click <strong>Create policy</strong>.</p>
</li>
</ol>
<h4 id="set-timeout-of-the-lambda-function">Set timeout of the Lambda function</h4>
<ol start="27">
<li>
<p>Now we need to configure the timeout of our Lambda function so it has time to run all the commands required to send our email. Under the same <strong>Configuration</strong> tab, click <strong>General Configuration</strong> from the left navigation.</p>
</li>
<li>
<p>Click <strong>Edit</strong>.</p>
</li>
<li>
<p>Set the <strong>Timeout</strong> to <strong>1 min 0 sec</strong>.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
<h4 id="test-the-vulnerability-summary-email">Test the vulnerability summary email</h4>
<ol start="31">
<li>
<p>We are ready to test our vulnerability summary email! Return to the <a href="https://us-east-1.console.aws.amazon.com/lambda/home?region=us-east-1#/functions/weekly-vulnerability-email?tab=code">Lambda console</a> and open the function you created.</p>
</li>
<li>
<p>Next to the <strong>Code source</strong> section, click the <strong>Test</strong> dropdown and select <strong>Configure test event</strong>. This should pop open a Configure test event window.</p>
</li>
<li>
<p>Under <strong>Event name</strong>, input &ldquo;<strong>Generate-Email</strong>&rdquo;. Then click <strong>Save</strong>. We don&rsquo;t need to worry about the Event JSON since we don&rsquo;t use that in our function. You should see a banner appear stating &ldquo;The test event Generate-Email was successfully saved.&rdquo;</p>
</li>
<li>
<p>Click <strong>Test</strong> again to run the test using your configuration. You&rsquo;ll see the Execution results under the <strong>Code Source</strong> section. Within a couple minutes you should receive an email with your vulnerability summary!</p>
</li>
</ol>

<div class="notices warning" ><p><strong>Note to Participants</strong>: If you do not receive an email, check the execution results for an error. Make sure the ARN of the SNS Topic that you configured an environment variable for ends in &ldquo;weekly-vulnerability-email&rdquo;. If there are any characters after &ldquo;email&rdquo;, remove them and save the environment variable. Then test again.</p>
</div>

<h4 id="schedule-the-weekly-vulnerability-summary-email-with-eventbridge">Schedule the weekly vulnerability summary email with EventBridge</h4>
<ol start="35">
<li>
<p>Finally, we need to create an EventBridge rule that will call the Lambda function we made on a weekly basis. Open EventBridge. <a href="https://us-east-1.console.aws.amazon.com/events/home">https://us-east-1.console.aws.amazon.com/events/home</a></p>
</li>
<li>
<p>Select <strong>EventBridge Schedule</strong> on the right. Click <strong>Create schedule</strong>.</p>
</li>
<li>
<p>On the <strong>Specify schedule detail</strong> page, name your rule <em>weekly-vulnerability-email</em>.</p>
</li>
<li>
<p>Under <strong>Schedule pattern</strong> select &ldquo;<strong>Recurring schedule</strong>&rdquo;</p>
</li>
<li>
<p>Leave &ldquo;<strong>Cron-based schedule</strong>&rdquo; selected.</p>
</li>
<li>
<p>We&rsquo;ll schedule the email every Monday at 7am CDT. Under the <strong>Cron expression</strong>, set <strong>cron( 0 12 ? * 2 * )</strong>. Select Local time zone from the drop down. You should see a preview of the <strong>Next 10 trigger date(s)</strong>.</p>
</li>
<li>
<p>Under &ldquo;<strong>Flexible time window</strong>&rdquo;, select &ldquo;<strong>Off</strong>&rdquo;. Then click <strong>Next</strong>.</p>
</li>
<li>
<p>On the <strong>Select target</strong> step, pick <strong>AWS Lambda - Invoke</strong>. Then select &ldquo;weekly-vulnerability-email&rdquo; from the Lambda function dropdown below. Click <strong>Next</strong>.</p>
</li>
<li>
<p>On the <strong>Settings</strong> step, click <strong>Next</strong>.</p>
</li>
<li>
<p>On the <strong>Review and create schedule step</strong>, click <strong>Create schedule</strong>.</p>
</li>
</ol>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="//localhost:1313/5/5.1/" title="Setting up notifications"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="//localhost:1313/5/5.3/" title="Automated Security Response on AWS" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="//localhost:1313/js/clipboard.min.js?1724174124"></script>
    <script src="//localhost:1313/js/perfect-scrollbar.min.js?1724174124"></script>
    <script src="//localhost:1313/js/perfect-scrollbar.jquery.min.js?1724174124"></script>
    <script src="//localhost:1313/js/jquery.sticky.js?1724174124"></script>
    <script src="//localhost:1313/js/featherlight.min.js?1724174124"></script>
    <script src="//localhost:1313/js/highlight.pack.js?1724174124"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="//localhost:1313/js/modernizr.custom-3.6.0.js?1724174124"></script>
    <script src="//localhost:1313/js/learn.js?1724174124"></script>
    <script src="//localhost:1313/js/hugo-learn.js?1724174124"></script>

    <link href="//localhost:1313/mermaid/mermaid.css?1724174124" rel="stylesheet" />
    <script src="//localhost:1313/mermaid/mermaid.js?1724174124"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
